# Общее описание работы с ПО

Для того чтобы получить результаты необходимо выполнить следующую последовательность действий:

1.	Задаться исходными данными: значение интервала и дистанций, количество аппаратов.
2.	Для заданных значений необходимо сформировать желаемые построения и описать их в виде массива положений в матрице формации. Данные описания помещаются в БД.
3.	Полученные массивы положений являются входными данными для работы алгоритма распределения. Результатом работы ПО, реализующий этот алгоритм станет совокупность массивов назначений, который так же запишется в БД.
4.	Следующим этапом будет подготовка полетного задания, описанного в терминах специальных команд.
5.	Далее необходимо для каждого аппарата запустить отдельный экземпляр ПО реализующего работы автопилота и физической модели. Каждый экземпляр должен иметь свой порядковый номер.
6.	Следующий шагом может быть запуск ПО визуализатора. Это позволит наблюдать за работой алгоритмов группового управления в режиме реального времени.
7.	Заключительным этапом является запуск ПО реализующего работу коллективного управления. Это ПО подключится по TCP к каждому экземпляру ПО эмулятора автопилота и запустит отдельный поток общения с ним по протоколу MAVLink. Окончательным результатом работы программы будут файлы, содержащие в себе значения положения и ориентации каждого аппарата во времени от момента запуска ПО эмулятора. В дальнейшем эти файлы можно использовать для анализа работы системы (построение по ним графиков).

# UavControl
Для корректной работы ПО симуляции работы автопилота и модели БЛА (далее ПО симулятора) необходима Linux среда (UNIX).
Сперва необходимо скачать исходный код ПО симулятора из открытого источника GitHub [Arducopter][]
 
Далее необходимо перейти из под консоли в директорию с исходным кодом используя команду: 
  
    cd /%SOURCE_FOLDER%/
Далее необходимо произвести сборку исходного кода под режим SITL. Для этого необходимо в консоли использовать команду
    make sitl
Результатом сборки должен стать файл расширения *.elf.
Для запуска симуляции необходимо ввести следующую комманду:

     ./ArduCopter.elf 
###Список дополнительных опций запуска
| Ключ опции      | Параметр ключа | Описание |
| :-------------------------------------------------------------------------------------------------------: | :-------: |---: |
|  --home	        | HOME     |  	Устанавливает начальную позицию модели в точке HOME (lat,lng,alt,yaw) |
|  --model	      |     MODEL   | 	    Устанавливает тип ЛА модели. Например quad или copter для квадракоптера.|
|  --console	    |	         |  Позволяет выводить всю информацию в консоль вместо TCP портов.|
|  --instance	    | N	         |      Устанавливает номер SITL (добавляет 10* N ко всем значениям TCP портов).|
|  --speedup	    | SPEEDUP     |      Устанавливает скорость симуляции|
|  --autotest-dir |	DIR	     |  Назначает директорию DIR для дополнительных файлов|

 * lat – широта в градусах;
 * lng – долгота в градусах; 
 * alt – высота над поверхностью в метрах;
 * yaw – угол курса в градусах.

Таким образом конечный вид команды запуска выглядит следующим образом:
 
      ./ArduCopter –home %lat%,%lng%,%alt%,%yaw% --model %MODEL% –instance %N%
      
Данный порядок установки работы SITL модели можно найти по следующей [ссылке][27].

[Arducopter]: https://github.com/diydrones/ardupilot 
[27]: http://dev.ardupilot.com/wiki/sitl-native-on-windows/
